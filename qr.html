<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.qrcode/1.0/jquery.qrcode.min.js"></script>
    <style type="text/css">
        div {
            position: absolute;
            top: 50%;
            left: 50%;
            margin-top: -128px;
            margin-left: -128px;
            width: 256px;
            height: 256px;
        }
    </style>
</head>

<body>
    <div class="div_qr_print"></div>
    <script>
        function renderqr() {
            if (window.location.hash) {
                var hash = window.location.hash.substring(1);
                $('.div_qr_print')
                    .empty()
                    .data("qr", {
                        "render": "canvas",
                        "text": hash
                    })
                    .qrcode($('.div_qr_print').data("qr"))
                    ;
            }
            else {
                $("body").append(
                    "<a href=\"javascript:location.href='https://adamgolan.github.io/qr.html#'+location.href\" title=\"drag and drop to bookmarks toolbar\">qr bookmarklet</a"
                );                    
            }
        }
        window.onhashchange = renderqr;
        renderqr();
    </script>
</body>
